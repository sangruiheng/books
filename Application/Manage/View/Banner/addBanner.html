<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>无标题文档</title>
    <include file="Common:common"/>
    <load href="__PUBLIC__/css/common/rightCommon.css"/>

    <load href="__PUBLIC__/tools/ueditor1_4_3-utf8-php/ueditor.config.js"/>
    <load href="__PUBLIC__/tools/ueditor1_4_3-utf8-php/ueditor.all.min.js"/>
    <load href="__PUBLIC__/tools/ueditor1_4_3-utf8-php/lang/zh-cn/zh-cn.js"/>
    <load href="__PUBLIC__/tools/webuploader-0.1.5/dist/webuploader.css"/>
    <load href="__PUBLIC__/tools/webuploader-0.1.5/examples/image-upload/style.css"/>


    <script>
        $(document).ready(function (e) {
            // if ($("#id").val() == '') {
            //     var ue = UE.getEditor('content');
            // }
            getEditData(function (e) {
              // console.log(e);
                var uploadImg = '';
                var uploadImg2 = '';
                // console.log(value.imgPath);
                uploadImg += '<div class="upload-listDiv">';
                uploadImg += '<img src="/Uploads/Manage/' + e.banner_img + '" width="120" height="120">';
                uploadImg += '<div class="upload-ldButton" data-url="' + e.banner_img + '">';
                // uploadImg += '<button type="button" onclick="javascript:delImg(this)" name="' + e.id + '" title="删除图片" class="btn btn-default upload-delete" ><i class="fa fa-trash-o"></i></button>';
                uploadImg += '<a class="btn btn-defaule upload-select" style="float:left"><i class="fa fa-book" aria-hidden="true"></i> 封面图片</a >';
                uploadImg += '</div>';
                uploadImg += '</div>';
                $('div#imgShow').append(uploadImg);

            });
        });
    </script>

    <style>
        .uploadify-button {
            height: 30px;
            line-height: 30px;
            width: 120px;
            border-radius: inherit;
            background: #5cb85c;
            border: none;
            font-family: '宋体';
        }

        .lable_id {
            float: left;
            margin: auto 17px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background: #ccc;
            height: 34px;
            line-height: 34px;
            padding-left: 12px;
            padding-right: 12px;
            cursor: pointer;
        }

        .addForm tr td .on {
            background-color: #449d44;
            color: #fff;
        }

        .fenlei_id {
            float: left;
            margin: auto 17px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background: #ccc;
            height: 34px;
            line-height: 34px;
            padding-left: 12px;
            padding-right: 12px;
            cursor: pointer;
        }
    </style>
</head>

<body>
<!--alert弹窗Start  -->
<div id="top-alert" class="fixed alert alert-error" style="display:none;">
    <button class="close fixed" style="margin-top: 4px;">&times;</button>
    <div class="alert-content">这是内容</div>
</div>
<!--alert弹窗end  -->
<nav class="navbar navbar-default" role="navigation">
    <div class="navbar-header">
        <a class="navbar-brand" href="#"><i class="fa fa-plus" aria-hidden="true"></i> <span id="changeTitle">添加</span>轮播图</a>
    </div>
</nav>

<div class="add-box">
    <form class="addForm ajax-alert" id="form1" name="form1" method="post"
          action="__APP__/Banner/addBannerData/controller/Banner/backUrl/bannerList/table/banner">
        <input name="id" type="hidden" id="id" value="<{$_GET['id']}>"/>
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
            <tbody>


            <tr>
                <td align="center">轮播图标题</td>
                <td><input type="text" name="banner_title" id="banner_title" class="form-control" placeholder="请输入轮播图标题"/></td>
            </tr>




            <tr>
                <td align="center">轮播图片<font color="red">&nbsp;&nbsp;*</font><br/><font color="#e61111" class="imgSize">750*400</font></td>
                <td style="padding:0px;">
                    <div id="uploader">
                        <div class="queueList">
                            <div id="dndArea" class="placeholder">
                                <div id="filePicker"></div>
                                <p>或将照片拖到这里，只能选择一张</p>
                            </div>
                        </div>
                        <div class="statusBar" style="display:none;">
                            <div class="progress"><span class="text">0%</span><span class="percentage"></span></div>
                            <div class="info"></div>
                            <div class="btns">
                                <div id="filePicker2"></div>
                                <div class="uploadBtn">开始上传</div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>


            <tr>
                <td align="center">已上传头图</td>
                <td>
                    <div id="imgShow">

                    </div>
                    <div id="imgShow1">

                    </div>
                    <input name="listCover" type="hidden" id="listCover" datatype="*" nullmsg="请上传图片并设置列表封面" value=""/>
                    <input name="bannerImg" type="hidden" id="bannerImg" datatype="*" nullmsg="请上传图片并设置Banner头图"/>
                </td>
            </tr>



            <tr>
                <td>&nbsp;</td>
                <td>
                    <button class="btn btn-success ajax-post" type="submit" id="saveButton"
                            target-form="form-horizontal"><i class="fa fa-check" aria-hidden="true"></i> 添加
                    </button>
                    <button type="button" class="btn btn-default" id="cancelButton"><i class="fa fa-times"
                                                                                       aria-hidden="true"></i> 取消
                    </button>
                </td>
            </tr>
            </tbody>
        </table>
    </form>
</div>
<load href="__PUBLIC__/tools/webuploader-0.1.5/dist/webuploader.js"/>
<load href="__PUBLIC__/tools/webuploader-0.1.5/examples/image-upload/upload1.js"/>
<script>
    function addCallback() {
        var imgNameVal = $('#listCover').val();
        var imgNameVal2 = $('#bannerImg').val();
        if (imgNameVal != '' && imgNameVal2 != '') {
            alert('为了节省服务器资源，请先删除现有图片！');
            return false;
        }
    }

    function uploadCallback(response) {
        /* var uploadHtml = '';
         uploadHtml += '<div class="upload-listDiv">';
         uploadHtml += '< img src="/Upload/' + response.url + '" height="160">';
         uploadHtml += '<div class="upload-ldButton" data-url="' + response.url + '">';
         uploadHtml += '<button type="button" onclick="javascript:delImg(this)" title="删除图片" class="btn btn-default upload-delete"><i class="fa fa-trash-o" aria-hidden="true"></i></button>';
         uploadHtml += '<button type="button" title="设为列表封面" class="btn btn-default upload-listCover"><i class="fa fa-book" aria-hidden="true"></i></button>';
         uploadHtml += '<button type="button" title="设为详情页头图" class="btn btn-default upload-detailsImg"><i class="fa fa-picture-o" aria-hidden="true"></i></button>';
         uploadHtml += '<a class="btn btn-defaule upload-select" style="float:left"></a >';
         uploadHtml += '</div>';
         uploadHtml += '</div>';
         $('div#imgShow').append(uploadHtml);*/
        var UrlHtml = '<input type="hidden" name="hid[]" value="/Uploads/Manage/' + response.url + '">';
        $('div#imgShow1').append(UrlHtml);
        //设为列表封面
        $('.upload-listCover').click(function () {
            var imgUrl = $(this).parent('div.upload-ldButton').attr('data-url');
            $(this).siblings('a.upload-select').html('<i class="fa fa-book" aria-hidden="true"></i> 列表封面');
            $('#listCover').val(imgUrl);
        });
        //设为详情页头图
        $('.upload-detailsImg').click(function () {
            var imgUrl = $(this).parent('div.upload-ldButton').attr('data-url');
            $(this).siblings('a.upload-select').html('<i class="fa fa-picture-o" aria-hidden="true"></i> 详情页头图');
            $('#bannerImg').val(imgUrl);
        });
    }

    $('.ajax-post').click(function () {
        var sowingMap = $('.filelist .success');
        var successImg = $('#imgShow .upload-listDiv');
        if(sowingMap.length == 0 && successImg.length == 0){
            $.show({
                title: '提示',
                isConfirm: false,
                content: '图片不能为空'
            });
            return false;
        }
    });
</script>



</body>
</html>
